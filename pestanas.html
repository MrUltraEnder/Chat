<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
    <link rel="shortcut icon" href="ios-message.ico" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
        .bg-fondo {
            background-color: rgb(188, 217, 250);
        }
        
        .btn-color {
            background-color: LightSteelBlue;
        }
        
        .btn-color.active {
            background-color: ivory;
        }
        
        .bg-barra {
            background-color: SteelBlue;
        }
        
        .deslizar {
            overflow-y: scroll;
        }
        
        .bg-pink {
            background-color: pink;
        }
        
        .bg-purple {
            background-color: purple;
        }
        
        .bg-orange {
            background-color: orange;
        }
        
        .bg-green {
            background-color: green;
        }
        
        .bg-black {
            background-color: black;
        }
        
        .bg-blue {
            background-color: blue;
        }
        
        .bg-brown {
            background-color: brown;
        }
    </style>
</head>

<body class="h-100">
    <template id="mensaje_chat">
        <div class="card mb-2 {COLOR} text-white">
            <div class="card-body">
                <img src="{IMAGEN}" id ={perfil} class='rounded float-start me-4' width='100px' height="100px"></img>
                <h6 class="card-title">{NOMBRE_PERSONAJE}</h6>
                {MENSAJE}
                <footer><em>{TIEMPO}</em></footer>
            </div>
        </div></template>
    <template id="mensaje_Juan">
        <div class="card text-end mb-2 {COLOR} text-white">
            <div class="card-body">
                <img src="{IMAGEN}" id ={perfil} class='rounded float-end ms-4' width='100px' height="100px"></img>
                <h6 class="card-title">{NOMBRE_PERSONAJE}</h6>
                {MENSAJE}
                <footer><em>{TIEMPO}</em></footer>
            </div>
        </div></template>
    <audio id="musica" autoplay>
  
  <source src="mylie.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
    <audio id="bup">
  
  <source src="audio.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

    <div class="container-fluid h-100">
        <div class="row  h-100">
            <div class="col-2 pt-2 h-100 bg-barra">
                <button type="button" id="btn1" class="btn btn-color w-100 my-1" onclick="con(1)">
            grupo de amixes üòéüëå
          </button>
                <button type="button" id="btn2" class="btn btn-color w-100 my-1" onclick="con(2)">bb <3 ü§°</button>
                <button type="button" id="btn3" class="btn btn-color w-100 my-1" onclick="con(3)">Uber üöì</button>
                <button type="button" id="botonmusica" class="btn btn-color my-1 fixed-bottom" onclick="musica()">üîä</button>
            </div>
            <div id="chats" class="col-10 bg-fondo h-100 d-flex deslizar">
                <div id="con1" class="mt-auto w-100">

                    <div class="card mb-2">
                        <div class="card-body">
                            ‚ùó Presiona Intro para comenzar
                        </div>

                    </div>

                </div>
                <div id="con2" class="mt-auto w-100 d-none"></div>
                <div id="con3" class="mt-auto w-100 d-none"></div>
            </div>

            <script>
                function con(id) {
                    document.getElementById("con1").classList.add("d-none");
                    document.getElementById("btn1").classList.remove("active");
                    document.getElementById("con2").classList.add("d-none");
                    document.getElementById("btn2").classList.remove("active");
                    document.getElementById("con3").classList.add("d-none");
                    document.getElementById("btn3").classList.remove("active");
                    document.getElementById("con" + id).classList.remove("d-none");
                    document.getElementById("btn" + id).classList.add("active");

                }
                var canMove = true;
                var mensaje_template = document.getElementById("mensaje_chat").innerHTML;
                var mensaje_juan = document.getElementById("mensaje_Juan").innerHTML;
                var i = 0;
                var mensajes = null;
                fetch('./mensajes.json').then(response => response.json()).then(lectura);

                document.addEventListener("keydown", tecleo);

                function tecleo(evento) {
                    if (evento.code == 'Enter' && i < mensajes.length && canMove) {

                        if (mensajes[i].nombre_personaje == "Juan") {
                            var html = mensaje_juan;

                        } else {
                            var html = mensaje_template;
                        }

                        html = html.replace("{NOMBRE_PERSONAJE}", mensajes[i].nombre_personaje);
                        html = html.replace("{MENSAJE}", mensajes[i].mensaje);
                        html = html.replace("{IMAGEN}", mensajes[i].imagen_de_perfil);
                        html = html.replace("{TIEMPO}", mensajes[i].hora_de_envio);
                        html = html.replace("{COLOR}", mensajes[i].color);

                        document.getElementById(mensajes[i].conversacion).innerHTML += html;
                        document.getElementById("bup").play();
                        con(mensajes[i].conversacion.replace("con", ""));
                        document.getElementById("chats").scrollTo(0, document.getElementById("chats").scrollHeight);
                        i++;
                        canMove = false;
                        setTimeout(function() {
                            canMove = true;
                        }, 1000);
                    }
                }

                function lectura(respuesta) {
                    mensajes = respuesta;
                }

                function aparecer() {
                    document.getElementById("textoC").innerHTML = "Mientras tanto Juan...";
                    document.getElementById("cortinilla").classList.remove("animate__fadeOut");
                    document.getElementById("cortinilla").classList.add("animate__fadeIn");
                    canMove = false;
                }

                function desvanecer() {
                    document.getElementById("cortinilla").classList.remove("animate__animated");

                    document.getElementById("cortinilla").classList.remove("animate__fadeIn");
                    document.getElementById("cortinilla").classList.add("animate__fadeOut");
                    document.getElementById("cortinilla").classList.add("animate__animated");
                    canMove = true;
                }

                function musica() {
                    var musica = document.getElementById("musica");
                    var botonmusica = document.getElementById("botonmusica");
                    if (musica.paused) {
                        musica.play();
                        botonmusica.innerHTML = "üîä";
                    } else {
                        musica.pause();
                        botonmusica.innerHTML = "üîá";
                    }
                }
            </script>
</body>

</html>