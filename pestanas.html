<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
    <link rel="shortcut icon" href="ios-message.ico" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
        .mensajes {
            min-width: 400px;
        }
        
        .bg-fondo {
            background-color: rgb(188, 217, 250);
        }
        
        .bg-fondoBarra {
            background-color: rgb(175, 212, 255);
        }
        
        .btn-color {
            background-color: LightSteelBlue;
        }
        
        .btn-color.active {
            background-color: ivory;
        }
        
        .bg-barra {
            background-color: SteelBlue;
        }
        
        .deslizar {
            overflow-y: scroll;
        }
        
        .bg-pink {
            background-color: rgb(199, 86, 105);
        }
        
        .bg-purple {
            background-color: purple;
        }
        
        .bg-orange {
            background-color: orange;
        }
        
        .bg-green {
            background-color: green;
        }
        
        .bg-black {
            background-color: black;
        }
        
        .bg-blue {
            background-color: rgb(45, 45, 138);
        }
        
        .bg-brown {
            background-color: brown;
        }
    </style>
</head>

<body class="h-100">
    <template id="mensaje_chat">
        <div class="card mb-2 {COLOR} pb-3 d-inline-block text-white mensajes">
            <div class="card-body pb-0">
                <img src="{IMAGEN}" id ={perfil} class='rounded float-start me-4' width='100px' height="100px"></img>
                <h6 class="card-title">{NOMBRE_PERSONAJE}</h6>
                {MENSAJE}
                <footer><em>{TIEMPO}</em></footer>
            </div>
        </div><br>
    </template>
    <template id="mensaje_Juan">
        <div class="clearfix">
        <div class="card text-end d-inline-block mb-2 float-end ms-auto me-0 pb-3 {COLOR} text-white mensajes">
            <div class="card-body pb-0">
                <img src="{IMAGEN}" id ={perfil} class='rounded float-end ms-4' width='100px' height="100px"></img>
                <h6 class="card-title">{NOMBRE_PERSONAJE}</h6>
                {MENSAJE}
                <footer><em>{TIEMPO}</em></footer>
            </div>
        </div>
        </div>
    </template>
    <audio id="musica" autoplay>
  
  <source src="mylie.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
    <audio id="bup">
  
  <source src="audio.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>

    <div class="container-fluid h-100">
        <div class="fixed-top">
            <div class="row">
                <div class="col-2"></div>

                <div class="col-10 py-0">
                    <img src="amigos.jpg" id="perfilBarra" class='mt-2 float-start me-4' width='50px' height="50px"></img>
                    <div id="BarraChat" class="bg-fondoBarra fs-2 py-2 ps-3">

                        Grupo de amixes üòéüëå</div>
                </div>
            </div>
        </div>

        <div class="row  h-100">
            <div class="col-2 pt-2 h-100 bg-barra">
                <button type="button" id="btn1" class="btn btn-color w-100 my-1" onclick="con(1)">
            Grupo de amixes üòéüëå
          </button>
                <button type="button" id="btn2" class="btn btn-color w-100 my-1" onclick="con(2)">bb <3 ü§°</button>
                <button type="button" id="btn3" class="btn btn-color w-100 my-1" onclick="con(3)">Uber üöì</button>
                <button type="button" id="botonmusica" class="btn btn-color my-1 fixed-bottom" onclick="musica()">üîä</button>
            </div>


            <div id="chats" class="deslizar col-10 bg-fondo h-100 d-flex ">

                <div id="con1" class="w-100 mt-auto ">

                    <div class="card mb-2">
                        <div class="card-body">
                            ‚ùó Presiona Intro para comenzar
                        </div>

                    </div>

                </div>
                <div id="con2" class="mt-auto w-100 d-none"></div>
                <div id="con3" class="mt-auto w-100 d-none"></div>
            </div>
        </div>


        <script>
            function imagenBarra(num) {
                switch (num) {
                    case '1':
                        document.getElementById("perfilBarra").src = "amigos.jpg";
                        break;
                    case '2':
                        document.getElementById("perfilBarra").src = "diana.png";
                    case '3':
                        document.getElementById("perfilBarra").src = "uber.png";
                }
                console.log(num);
            }

            function con(id) {
                document.getElementById("con1").classList.add("d-none");
                document.getElementById("btn1").classList.remove("active");
                document.getElementById("con2").classList.add("d-none");
                document.getElementById("btn2").classList.remove("active");
                document.getElementById("con3").classList.add("d-none");
                document.getElementById("btn3").classList.remove("active");
                document.getElementById("con" + id).classList.remove("d-none");
                document.getElementById("btn" + id).classList.add("active");

            }
            var canMove = true;
            var mensaje_template = document.getElementById("mensaje_chat").innerHTML;
            var mensaje_juan = document.getElementById("mensaje_Juan").innerHTML;
            var i = 0;
            var mensajes = null;
            fetch('./mensajes.json').then(response => response.json()).then(lectura);

            document.addEventListener("keydown", tecleo);

            function tecleo(evento) {
                if (evento.code == 'Enter' && i < mensajes.length && canMove) {

                    if (mensajes[i].nombre_personaje == "Juan") {
                        var html = mensaje_juan;

                    } else {
                        var html = mensaje_template;
                    }

                    html = html.replace("{NOMBRE_PERSONAJE}", mensajes[i].nombre_personaje);
                    html = html.replace("{MENSAJE}", mensajes[i].mensaje);
                    html = html.replace("{IMAGEN}", mensajes[i].imagen_de_perfil);
                    html = html.replace("{TIEMPO}", mensajes[i].hora_de_envio);
                    html = html.replace("{COLOR}", mensajes[i].color);

                    document.getElementById(mensajes[i].conversacion).innerHTML += html;
                    document.getElementById("bup").play();
                    con(mensajes[i].conversacion.replace("con", ""));
                    imagenBarra(mensajes[i].conversacion.replace("con", ""));
                    document.getElementById("BarraChat").innerHTML = document.getElementById("btn" + mensajes[i].conversacion.replace("con", "")).innerHTML;
                    document.getElementById("chats").scrollTo(0, document.getElementById("chats").scrollHeight);
                    i++;
                    canMove = false;
                    setTimeout(function() {
                        canMove = true;
                    }, 1000);
                }
            }

            function lectura(respuesta) {
                mensajes = respuesta;
            }

            function aparecer() {
                document.getElementById("textoC").innerHTML = "Mientras tanto Juan...";
                document.getElementById("cortinilla").classList.remove("animate__fadeOut");
                document.getElementById("cortinilla").classList.add("animate__fadeIn");
                canMove = false;
            }

            function desvanecer() {
                document.getElementById("cortinilla").classList.remove("animate__animated");

                document.getElementById("cortinilla").classList.remove("animate__fadeIn");
                document.getElementById("cortinilla").classList.add("animate__fadeOut");
                document.getElementById("cortinilla").classList.add("animate__animated");
                canMove = true;
            }

            function musica() {
                var musica = document.getElementById("musica");
                var botonmusica = document.getElementById("botonmusica");
                if (musica.paused) {
                    musica.play();
                    botonmusica.innerHTML = "üîä";
                } else {
                    musica.pause();
                    botonmusica.innerHTML = "üîá";
                }
            }
        </script>
</body>

</html>